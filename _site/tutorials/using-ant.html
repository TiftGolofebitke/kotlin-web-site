<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">


<link rel="Shortcut Icon" href="/assets/images/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/assets/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/assets/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/assets/images/apple-touch-icon-144x144.png" />
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/css/syntax.css">
<link rel="stylesheet" href="/css/keywords.css">


<title>Using Ant</title>

</head>
<body>
<section>
    <div class="container">
        <div class="grid">
            <div class="row">
                <div class="col-2">
                    <h1>Using Ant</h1>
                    <!--<ul class="navigation">
                        <li><a href="">Docs Home</a></li>
                        <li><a href="">Examples</a></li>
                        <li><a href="">Comparison to Java</a></li>
                        <li><a href="">Comparison to Scala</a></li>
                        <li><a href="">Modules and Compilation</a></li>
                        <li><a href="">Packages</a></li>
                        <li><a href="">Functions</a></li>
                        <li><a href="">Properties And Fields</a></li>
                    </ul>-->
                    <div id="toc"></div>
                </div>
                <div class="col-4">
                    <h3 id="getting-the-ant-tasks">Getting the Ant Tasks</h3>

<p>Kotlin provides three tasks for Ant:</p>

<ul>
  <li>kotlinc: Kotlin compiler targeting the JVM</li>
  <li>kotlin2js: Kotlin compiler targeting JavaScript</li>
  <li>withKotin: Task to compile Kotlin files when using the standard <em>javac</em> Ant task</li>
</ul>

<p>These tasks are defined in the <em>kotlin-ant.jar</em> library which is located in the <em>lib</em> folder for the <a href="https://github.com/JetBrains/kotlin/releases?after=build-0.6.173">Kotlin Compiler</a></p>

<h3 id="targeting-jvm-with-kotlin-only-source">Targeting JVM with Kotlin-only source</h3>

<p>When the project consists of exclusively Kotlin source code, the easiest way to compile the project is to use the <em>kotlinc</em> task</p>

<div class="highlight"><pre><code class="xml"><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;Ant Task Test&quot;</span> <span class="na">default=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;typedef</span> <span class="na">resource=</span><span class="s">&quot;org.jetbrains.jet.buildtools.ant.antlib.xml&quot;</span> <span class="na">classpath=</span><span class="s">&quot;${kotlin.lib}/kotlin-ant.jar&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;kotlinc</span> <span class="na">src=</span><span class="s">&quot;hello.kt&quot;</span> <span class="na">output=</span><span class="s">&quot;hello.jar&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div>

<p>where ${kotlin.lib} points to the folder where the Kotlin standalone compiler was unzipped.</p>

<h3 id="targeting-jvm-with-kotlin-only-source-and-multiple-roots">Targeting JVM with Kotlin-only source and multiple roots</h3>

<p>If a project consists of multiple source roots, use <em>src</em> as elements to define paths</p>

<div class="highlight"><pre><code class="xml"><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;Ant Task Test&quot;</span> <span class="na">default=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;typedef</span> <span class="na">resource=</span><span class="s">&quot;org.jetbrains.jet.buildtools.ant.antlib.xml&quot;</span> <span class="na">classpath=</span><span class="s">&quot;${kotlin.lib}/kotlin-ant.jar&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;kotlinc</span> <span class="na">output=</span><span class="s">&quot;hello.jar&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;src</span> <span class="na">path=</span><span class="s">&quot;root1&quot;</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;src</span> <span class="na">path=</span><span class="s">&quot;root2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/kotlinc&gt;</span>
    <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div>

<h3 id="targeting-jvm-with-kotlin-and-java-source">Targeting JVM with Kotlin and Java source</h3>

<p>If a project consists of both Kotlin and Java source code, while it is possible to use <em>kotlinc</em>, to avoid repetition of task parameters, it is
recommended to use <em>withKotlin</em> task</p>

<div class="highlight"><pre><code class="xml"><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;Ant Task Test&quot;</span> <span class="na">default=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>

  <span class="nt">&lt;path</span> <span class="na">id=</span><span class="s">&quot;classpath&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">&quot;${idea.sdk}/lib&quot;</span> <span class="na">includes=</span><span class="s">&quot;annotations.jar&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">&quot;${kotlin.home}&quot;</span> <span class="na">includes=</span><span class="s">&quot;kotlin-runtime.jar&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/path&gt;</span>

  <span class="nt">&lt;typedef</span> <span class="na">name =</span> <span class="s">&quot;withKotlin&quot;</span> <span class="na">classname =</span> <span class="s">&quot;org.jetbrains.jet.buildtools.ant.KotlinCompilerAdapter&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;delete</span> <span class="na">dir=</span><span class="s">&quot;classes&quot;</span> <span class="na">failonerror=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;mkdir</span> <span class="na">dir=</span><span class="s">&quot;classes&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;javac</span> <span class="na">destdir=</span><span class="s">&quot;classes&quot;</span> <span class="na">includeAntRuntime=</span><span class="s">&quot;false&quot;</span> <span class="na">srcdir=</span><span class="s">&quot;root1&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;classpath</span> <span class="na">refid=</span><span class="s">&quot;classpath&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;withKotlin</span> <span class="na">externalannotations=</span><span class="s">&quot;root1/b/&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;externalannotations</span> <span class="na">path=</span><span class="s">&quot;root1/a/&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/withKotlin&gt;</span>
      <span class="nt">&lt;/javac&gt;</span>
      <span class="nt">&lt;jar</span> <span class="na">destfile=</span><span class="s">&quot;hello.jar&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">&quot;/classes&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/jar&gt;</span>
  <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div>

<h3 id="targeting-javascript-with-single-source-folder">Targeting JavaScript with single source folder</h3>

<div class="highlight"><pre><code class="xml"><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;Ant Task Test&quot;</span> <span class="na">default=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;typdef</span> <span class="na">resource=</span><span class="s">&quot;org.jetbrains.jet.buildtools.ant.antlib.xml&quot;</span> <span class="na">classpath=</span><span class="s">&quot;${kotlin.lib}/kotlin-ant.jar&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;kotlin2js</span> <span class="na">src=</span><span class="s">&quot;root1&quot;</span> <span class="na">output=</span><span class="s">&quot;out.js&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div>

<h3 id="targeting-javascript-with-prefix-postfix-and-sourcemap-options">Targeting JavaScript with Prefix, PostFix and sourcemap options</h3>

<div class="highlight"><pre><code class="xml"><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;Ant Task Test&quot;</span> <span class="na">default=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;taskdef</span> <span class="na">resource=</span><span class="s">&quot;org.jetbrains.jet.buildtools.ant.antlib.xml&quot;</span> <span class="na">classpath=</span><span class="s">&quot;${kotlin.lib}/kotlin-ant.jar&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">&quot;build&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;kotlin2js</span> <span class="na">src=</span><span class="s">&quot;root1&quot;</span> <span class="na">output=</span><span class="s">&quot;out.js&quot;</span> <span class="na">outputPrefix=</span><span class="s">&quot;prefix&quot;</span> <span class="na">outputPostfix=</span><span class="s">&quot;postfix&quot;</span> <span class="na">sourcemap=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div>

<h3 id="references">References</h3>

<p>Complete list of elements and attributes are listed below</p>

<h4 id="kotlinc-attributes">kotlinc Attributes</h4>

<table>
  <tbody>
    <tr>
      <td>Name</td>
      <td>Description</td>
      <td>Required</td>
      <td>Default Value</td>
    </tr>
    <tr>
      <td>src</td>
      <td>Kotlin source file or directory to compile</td>
      <td>Either src or module needs to be defined</td>
      <td> </td>
    </tr>
    <tr>
      <td>module</td>
      <td>Kotlin module to compile</td>
      <td>Either src or module needs to be defined</td>
      <td> </td>
    </tr>
    <tr>
      <td>output</td>
      <td>Destination directory</td>
      <td>Either output or jar is required</td>
      <td> </td>
    </tr>
    <tr>
      <td>classpath</td>
      <td>Compilation class path</td>
      <td>No</td>
      <td> </td>
    </tr>
    <tr>
      <td>classpathref</td>
      <td>Compilation class path reference</td>
      <td>No</td>
      <td> </td>
    </tr>
    <tr>
      <td>stdlib</td>
      <td>Path to “kotlin-runtime.jar”</td>
      <td>No</td>
      <td>””</td>
    </tr>
    <tr>
      <td>includeRuntime</td>
      <td>If “jar” is used, whether Kotlin runtime library is included</td>
      <td>No</td>
      <td>true</td>
    </tr>
  </tbody>
</table>

<h4 id="withkotlin-attributes">withKotlin attributes</h4>

<table>
  <tbody>
    <tr>
      <td>Name</td>
      <td>Description</td>
      <td>Required</td>
      <td>Default Value</td>
    </tr>
    <tr>
      <td>externalannotations</td>
      <td>Path to external annotations</td>
      <td>No</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 id="kotlin2js-attributes">kotlin2js Attributes</h4>

<table>
  <tbody>
    <tr>
      <td>Name</td>
      <td>Description</td>
      <td>Required</td>
    </tr>
    <tr>
      <td>src</td>
      <td>Kotlin source file or directory to compile</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>output</td>
      <td>Destination file</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>library</td>
      <td>Library files (kt, dir, jar)</td>
      <td>No</td>
    </tr>
    <tr>
      <td>outputPrefix</td>
      <td>Prefix to use for generated JavaScript files</td>
      <td>No</td>
    </tr>
    <tr>
      <td>outputSuffix</td>
      <td>Suffix to use for generated JavaScript files</td>
      <td>No</td>
    </tr>
    <tr>
      <td>sourcemap</td>
      <td>Whether sourcemap file should be generated</td>
      <td>No</td>
    </tr>
    <tr>
      <td>main</td>
      <td>Should compiler generated code call the main function</td>
      <td>No</td>
    </tr>
  </tbody>
</table>


                </div>
            </div>
        </div>

    </div>
    <div id="related">
        <h4>Related</h4>


        

    </div>

    <!--
Footer details such as copyright notice, etc.
-->

    <!--
Include all scripts required here
-->

<script type="text/javascript" src="/scripts/jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="/scripts/jquery.toc.min.js"></script>


    
</section>
</body>
</html>

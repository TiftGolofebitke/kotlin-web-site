<!DOCTYPE html>
    <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link rel="Shortcut Icon" href="/assets/images/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/assets/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/assets/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/assets/images/apple-touch-icon-144x144.png" />
<link rel="stylesheet" href="/css/styles.css">
<!--
<link rel="stylesheet" href="/css/syntax.css">
<link rel="stylesheet" href="/css/keywords.css">
-->
<title>Operator overloading</title>

</head>
<body>

<div class="global-layout">
    <header class="global-header">
    <div class="g-layout">
        <a class="global-header-logo" href="">Project Kotlin</a>

        <form class="global-header-search">
            <div class="search-input-wrap">
                <input type="text" class="search-input">
            </div>
            <input type="submit" class="search-submit-button">
        </form>

        <nav class="global-header-nav">
            
                
                    <a href="/"
                       class="nav-item">
                        Home
                    </a>
                
            
                
                    <a href="/try/"
                       class="nav-item">
                        Try
                    </a>
                
            
                
                    <a href="/download/"
                       class="nav-item">
                        Download
                    </a>
                
            
                
                    <span class="nav-item is_active">
                        Learn
                    </span>
                
            
                
                    <a href="/contribute/"
                       class="nav-item">
                        Contribute
                    </a>
                
            
        </nav>

    </div>
</header>
    
    

    <div class="global-current-section">
        <div class="g-layout">
            <div class="current-section-title">Learn Kotlin</div>

            
                <ul class="current-section-nav">
                    
                        
                            <li class="nav-item">
                                <a href="/learn/" class="nav-item-text">Getting Started</a>
                            </li>

                        
                    
                        
                            <li class="nav-item is_active">
                                <a href="/docs/" class="nav-item-text">Documentation</a>
                            </li>

                        
                    
                        
                            <li class="nav-item">
                                <a href="/learn/faq/" class="nav-item-text">FAQ</a>
                            </li>

                        
                    
                        
                            <li class="nav-item">
                                <a href="/tutorials/" class="nav-item-text">Tutorials</a>
                            </li>

                        
                    
                        
                            <li class="nav-item">
                                <a href="/learn/videos/" class="nav-item-text">Videos</a>
                            </li>

                        
                    
                        
                            <li class="nav-item">
                                <a href="/learn/events/" class="nav-item-text">Events</a>
                            </li>

                        
                    
                        
                            <li class="nav-item">
                                <a href="/learn/external/" class="nav-item-text">External Resources</a>
                            </li>

                        
                    
                </ul>
            

        </div>
    </div>



    <div class="global-content">
        <h1 class="page-title">Operator overloading</h1>

        <p>Kotlin allows us to provide implementations for a predefined set of operators on our types. These operators have fixed symbolic representation 
(like ‘+’ or ‘*’) and fixed [precedence|Grammar#Precedence]. To implement an operator, one provides a [member function|Functions#Member functions] 
or an [extension function|Extension functions] with a fixed name, for the corresponding type, i.e. left-hand side type for binary operations and argument type for unary ones.</p>

<h2 id="conventions">Conventions</h2>

<p>Here we describe the conventions that regulate operator overloading for different operators.</p>

<h3 id="unary-operations">Unary operations</h3>

<table>
  <tbody>
    <tr>
      <td>Expression</td>
      <td>Translated to</td>
    </tr>
    <tr>
      <td>+a</td>
      <td>a.plus()</td>
    </tr>
    <tr>
      <td>-a</td>
      <td>a.minus()</td>
    </tr>
    <tr>
      <td>!a</td>
      <td>a.not()</td>
    </tr>
  </tbody>
</table>

<p>This table says that when the compiler processes, for example, an expression +a, it performs the following steps:</p>

<ul>
  <li>Determines the type of a, let it be T.</li>
  <li>Looks up a function plus() with no parameters for the receiver T, i.e. a member function or an extension function.</li>
  <li>If the function is absent or ambiguous, it is a compilation error.</li>
  <li>If the function is present and its return type is R, the expression +a has type R.</li>
</ul>

<p><em>Note</em> that these operations, as well as all the others, are optimized for [Basic types] and do not introduce overhead of function calls for them.</p>

<table>
  <tbody>
    <tr>
      <td>Expression</td>
      <td> </td>
      <td>Translated to</td>
    </tr>
    <tr>
      <td>a++</td>
      <td>a.inc() + see below</td>
      <td> </td>
    </tr>
    <tr>
      <td>a–</td>
      <td>a.dec() + see below</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>These operations are supposed to change their receiver and (optionally) return a value.
{note:title=inc()/dec() shouldn’t mutate the receiver object}
By “changing the receiver” we mean the receiver-variable, not the receiver object.
{note}</p>

<p>The compiler performs the following steps for resolution of an operator in the <em>postfix</em> form, e.g. a++:
* Determines the type of a, let it be T.
* Looks up a function inc() with no parameters, applicable to the receiver of type T.
* If the function returns a type R, then it must be a subtype of T.</p>

<p>The effect of computing the expression is:
* Store the initial value of a to a temporary storage a0,
* Assign the result of a.inc() to a,
* Return a0 as a result of the expression.</p>

<p>For a– the steps are completely analogous.</p>

<p>For the <em>prefix</em> forms ++a and –a resolution works the same way, and the effect is:
* Assign the result of a.inc() to a,
* Return the new value of a as a result of the expression.</p>

<h3 id="binary-operations">Binary operations</h3>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>Expression</td>
      <td> </td>
      <td>Translated to</td>
      <td> </td>
    </tr>
    <tr>
      <td>a + b</td>
      <td>a.plus(b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a - b</td>
      <td>a.minus(b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a * b</td>
      <td>a.times(b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a / b</td>
      <td>a.div(b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a % b</td>
      <td>a.mod(b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a..b</td>
      <td>a.rangeTo(b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>For the operations in this table, the compiler just resolves the expression in the <em>Translated to</em> column.</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>Expression</td>
      <td> </td>
      <td>Translated to</td>
      <td> </td>
    </tr>
    <tr>
      <td>a in b</td>
      <td>b.contains(a)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a !in b</td>
      <td>!b.contains(a)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>{anchor:in}
For <em>in</em> and <em>!in</em> the procedure is the same, but the order of arguments is reversed.</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>Symbol</td>
      <td> </td>
      <td>Translated to</td>
      <td> </td>
    </tr>
    <tr>
      <td>a[i]</td>
      <td>a.get(i)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a[i, j]</td>
      <td>a.get(i, j)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a[i_1, …,  i_n]</td>
      <td>a.get(i_1, …,  i_n)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a[i] = b</td>
      <td>a.set(i, b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a[i, j] = b</td>
      <td>a.set(i, j, b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a[i_1, …,  i_n] = b</td>
      <td>a.set(i_1, …, i_n, b)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Square brackets are translated to calls to get and set with appropriate numbers of arguments.</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>Symbol</td>
      <td> </td>
      <td>Translated to</td>
      <td> </td>
    </tr>
    <tr>
      <td>a(i)</td>
      <td>a.invoke(i)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a(i, j)</td>
      <td>a.invoke(i, j)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a(i_1, …,  i_n)</td>
      <td>a.invoke(i_1, …,  i_n)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Parentheses are translated to calls to invoke with appropriate number of arguments.</p>

<p>{anchor:assignments}
||Expression||Translated to||
| a += b | a.plusAssign(b) |
| a -= b | a.minusAssign(b) |
| a *= b | a.timesAssign(b) |
| a /= b | a.divAssign(b) |
| a %= b | a.modAssign(b) |</p>

<p>For the assignment operations, e.g. a += b, the compiler performs the following steps:
* If the function from the right column is available
  * If the corresponding binary function (i.e. plus() for plusAssign()) is available too, report error (ambiguity).
  * Make sure its return type is Unit, and report an error otherwise.
  * Generate code for a.plusAssign(b)
* Otherwise, try to generate code for a = a + b (this includes a type check: the type of a + b must be a subtype of a).</p>

<p><em>Note</em>: assignments are <em>NOT</em> expressions in Kotlin.</p>

<p>{anchor:Equals}</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>Expression</td>
      <td> </td>
      <td>Translated to</td>
      <td> </td>
    </tr>
    <tr>
      <td>a == b</td>
      <td>a?.equals(b) ?: b.identityEquals(null)</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a != b</td>
      <td>!(a?.equals(b) ?: b.identityEquals(null))</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p><em>Note</em>: identityEquals checks if two references point to the same object.</p>

<p>The == operation is special in two ways:
* It is translated to a complex expression that screens for <em>null</em>’s, and null == null is <em>true</em>.
* It looks up a function with a specific <em>signature</em>, not just a specific <em>name</em>. The function must be declared as</p>

<div class="highlight"><pre><code class="kotlin"><span class="k">fun</span> <span class="nf">equals</span><span class="p">(</span><span class="n">other</span> <span class="p">:</span> <span class="n">Any</span><span class="p">?)</span> <span class="p">:</span> <span class="n">Boolean</span>
</code></pre></div>

<p>Or an extension function with the same parameter list and return type.</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>Symbol</td>
      <td> </td>
      <td>Translated to</td>
      <td> </td>
    </tr>
    <tr>
      <td>a &gt; b</td>
      <td>a.compareTo(b) &gt; 0</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a &lt; b</td>
      <td>a.compareTo(b) &lt; 0</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a &gt;= b</td>
      <td>a.compareTo(b) &gt;= 0</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>a &lt;= b</td>
      <td>a.compareTo(b) &lt;= 0</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>All comparisons are translated into calls to compareTo, that is required to return Int.</p>

<h2 id="infix-calls-for-named-functions">Infix calls for named functions</h2>

<p>We can simulate custom infix operations by using <a href="/docs/functions.html#infix-notation">infix function calls</a>.</p>

    </div>

</div>

<footer class="global-footer">

    <div class="global-footer-externals">
        <div class="g-layout">
            <div class="g-8">
                <div class="header">Stay Tuned!</div>
                <ul class="externals-links-list">
                    <li class="list-item">
                        <a href="http://twitter.com/project_kotlin" class="link link_twitter">
                            <span class="icon icon_twitter"></span>
                            <span class="text">@project_kotlin</span>
                        </a>
                    </li>

                    <li class="list-item">
                        <a href="https://plus.google.com/communities/104597899765146112928" class="link link_gplus">
                            <span class="icon gray-icon icon_gplus"></span>
                            <span class="text">Google+</span>
                        </a>
                    </li>

                    <li class="list-item">
                        <a href="http://blog.jetbrains.com/kotlin/" class="link link_blog">
                            <span class="icon gray-icon icon_blog"></span>
                            <span class="text">Blog</span>
                        </a>
                    </li>

                    <li class="list-item">
                        <a href="http://youtrack.jetbrains.com/issues/KT" class="link link_issue-tracker">
                            <span class="icon gray-icon icon_youtrack"></span>
                            <span class="text">Issue Tracker</span>
                        </a>
                    </li>

                    <li class="list-item">
                        <a href="http://devnet.jetbrains.net/community/kotlin" class="link link_forum">
                            <span class="icon gray-icon icon_forum"></span>
                            <span class="text">Forum</span>
                        </a>
                    </li>
                </ul>
            </div>

        </div>
    </div>

    <div class="global-footer-terms">
        <div class="g-layout">

            <div class="terms-copyright">
                &copy; 2000-2013 JetBrains. All rights reserved
                <br>
                <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>
            </div>

            <div class="terms-sponsor">
                Sponsored and developed by <a href="http://jetbrains.com" class="sponsor sponsor_jetbrains">JetBrains</a>
            </div>
        </div>
    </div>

</footer>
<!--
Include all scripts required here
-->

<script type="text/javascript" src="/scripts/jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="/scripts/jquery.toc.min.js"></script>

</body>
</html>
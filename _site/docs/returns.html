<!DOCTYPE html>
    <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">


<link rel="Shortcut Icon" href="/kotlin-web-site/assets/images/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/kotlin-web-site/assets/images/apple-touch-icon.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/kotlin-web-site/assets/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/kotlin-web-site/assets/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/kotlin-web-site/assets/images/apple-touch-icon-144x144.png" />
<link rel="stylesheet" href="/kotlin-web-site/css/styles.css">
<link rel="stylesheet" href="/kotlin-web-site/css/syntax.css">
<link rel="stylesheet" href="/kotlin-web-site/css/keywords.css">


<title>Returns and Jumps</title>

    </head>
    <body>
    <section>
        <div class="container">
            <div class="grid">
                <div class="row">
                    <div class="col-2">
                        <h1>Returns and Jumps</h1>
                        <!--<ul class="navigation">
                            <li><a href="">Docs Home</a></li>
                            <li><a href="">Examples</a></li>
                            <li><a href="">Comparison to Java</a></li>
                            <li><a href="">Comparison to Scala</a></li>
                            <li><a href="">Modules and Compilation</a></li>
                            <li><a href="">Packages</a></li>
                            <li><a href="">Functions</a></li>
                            <li><a href="">Properties And Fields</a></li>
                        </ul>-->
                        <div id="toc"></div>
                    </div>
                    <div class="col-4">
                            <p>Kotlin has three structural jump operators</p>

<ul>
  <li>return. By default returns from the nearest enclosing function.</li>
  <li>break. Terminates the nearest enclosing loop.</li>
  <li>continue. Proceeds to the next step of the nearest enclosing loop or to the next branch in the nearest enclosing <a href="/docs/control-flow.html#when-expression">when expression</a></li>
</ul>

<h2 id="break-and-continue-labels">Break and Continue Labels</h2>

<p>Any expression in Kotlin may be marked with a <em class="keyword">label</em>.
Labels have the from of the @ sign followed by an optional identifier, for examples @, @abc, @fooBar are valid labels (see the <a href="/docs/grammar.html#label">grammar</a>).
To label an expression, we just put a label in front of it</p>

<div class="highlight"><pre><code class="kotlin"><span class="n">@loop</span> <span class="nf">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="m">100</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>

<p>Now, we can qualify a break or continue with a label:</p>

<div class="highlight"><pre><code class="kotlin"><span class="n">@loop</span> <span class="nf">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="m">100</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="k">in</span> <span class="m">1.</span><span class="p">.</span><span class="m">100</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(...)</span>
      <span class="k">break</span><span class="n">@loop</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>A break qualified with a label jumps to the execution point right after the loop marked with that label. A continue proceeds to the next iteration of that loop.</p>

<h2 id="return-at-labels">Return at Labels</h2>

<p>With function literals, local functions and object expression, functions can be nested in Kotlin. Qualified return’s allow us to return from an outer function. The most important use case is returning from a function literal. Recall that when we write this:</p>

<div class="highlight"><pre><code class="kotlin"><span class="k">fun</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">ints</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">it</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span>
    <span class="n">print</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The return expression returns from the nearest enclosing function, i.e. foo. If we need to return from a function literal, we have to label it and qualify the return</p>

<div class="highlight"><pre><code class="kotlin"><span class="k">fun</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">ints</span><span class="p">.</span><span class="n">forEach</span> <span class="n">@lit</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">it</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span><span class="n">@lit</span>
    <span class="n">print</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Now, it returns only from the function literal. Often times it is more convenient to use the shortest implicit label @ for function literals</p>

<div class="highlight"><pre><code class="kotlin"><span class="k">fun</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">ints</span><span class="p">.</span><span class="n">forEach</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">it</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span><span class="err">@</span> <span class="c1">// Works if there&#39;s one and only one function literal in lexical scope up to named entity (function or class)</span>
    <span class="n">print</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Note that such non-local returns are supported only for function literals passed to inline-functions.</p>

<p>When returning a value, the parser gives preference to the qualified return, i.e.</p>

<div class="highlight"><pre><code class="kotlin"><span class="k">return</span><span class="n">@a</span> <span class="m">1</span>
</code></pre></div>

<p>means “return 1 at label @a” and not “return a labeled expression (@a 1)”.</p>

<p>Named functions automatically define labels</p>

<div class="highlight"><pre><code class="kotlin"><span class="k">fun</span> <span class="nf">outer</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">fun</span> <span class="nf">inner</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span><span class="n">@outer</span> <span class="c1">// the label @outer was defined automatically</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Non-local returns are not implemented yet
 See the corresponding <a href="http://youtrack.jetbrains.com/issue/KT-1435">issue</a>.</em></p>

<h2 id="break-and-continue-in-custom-control-structures">Break and continue in custom control structures</h2>

<p>Inline functions make writing performant “custom control structures” easy, for example, the forEach() function that executes a function literal for every element in a collection</p>

<div class="highlight"><pre><code class="kotlin"><span class="n">inline</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Collection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;.</span><span class="n">forEach</span><span class="p">(</span><span class="n">body</span> <span class="p">:</span> <span class="p">(</span><span class="n">item</span> <span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">Unit</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">item</span> <span class="k">in</span> <span class="k">this</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">body</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Note that this function is not exactly a redundant example easily substitutable by a normal for loop. Consider the following code</p>

<div class="highlight"><pre><code class="kotlin"><span class="n">ints</span> <span class="n">filter</span> <span class="p">{</span><span class="n">it</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">}</span> <span class="n">sortby</span> <span class="p">{-</span><span class="n">it</span><span class="p">}</span> <span class="n">forEach</span> <span class="p">{</span><span class="n">print</span><span class="p">(</span><span class="n">it</span><span class="p">)}</span>
</code></pre></div>

<p>Now, what happens when we write break (or continue) inside the body of forEach? We simply get a compile-time error, because, lexically, there’s no loop to break</p>

<div class="highlight"><pre><code class="kotlin"><span class="n">ints</span> <span class="n">forEach</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">it</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="k">break</span> <span class="c1">// Error: &#39;break&#39; does not belong to a loop</span>
  <span class="n">print</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p>But, actually, there is a loop, hidden inside forEach, and it is inlined there, so we should be able to tell the compiler to understand that. An we can, by annotating the loop inside forEach with the loop annotation. The function parameter should also be annotated with loopbody annotation</p>

<div class="highlight"><pre><code class="kotlin"><span class="n">inline</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">Collection</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;.</span><span class="n">forEach</span><span class="p">(</span><span class="n">loopbody</span> <span class="n">body</span> <span class="p">:</span> <span class="p">(</span><span class="n">item</span> <span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">Unit</span><span class="p">)</span> <span class="p">{</span>
<span class="na">  [loop]</span> <span class="k">for</span> <span class="p">(</span><span class="n">item</span> <span class="k">in</span> <span class="k">this</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">body</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Now, the compiler allows break and continue in the function literal argument passed to forEach, and these operators apply to the loop marked with @@.</p>

<p><em>Break and continue for custom control structures are not implemented yet. See the corresponding <a href="http://youtrack.jetbrains.com/issue/KT-1436">issue</a>.</em></p>

                    </div>
                </div>
            </div>

        </div>
        <div id="related">
            <h4>Related</h4>


            

        </div>

        <!--
Footer details such as copyright notice, etc.
-->

        <!--
Include all scripts required here
-->

<script type="text/javascript" src="/kotlin-web-site/scripts/jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="/kotlin-web-site/scripts/jquery.toc.min.js"></script>


        
    </section>
    </body>
</html>
